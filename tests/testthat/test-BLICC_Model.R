# options(digits=20)

test_that("Selectivity function", {
  expect_equal(
    sum(abs(Rsel_dsnormal(Sp=c(30, 0.1, 0.2), LMP=seq(15.5, 25.5, by=1.0))-
              c(7.3953463438962621576e-10,1.2161385837529812455e-08,
                1.6373771305908126076e-07,1.8049096912131340013e-06,
                1.6289334328458021265e-05,1.2036280516721315967e-04,
                7.2815253908946038584e-04,3.6065631360157304926e-03,
                1.4625334709594208296e-02,4.8557821270009945969e-02,
                1.3199384318783022318e-01))),
    0, tolerance=1.0e-8)
})

glq <- statmod::gauss.quad(90, kind = "laguerre", alpha = 0.0)

test_that("Population function", {
  expect_equal(
    sum(abs(Rpop_len(glq$nodes, glq$weights, Len=15:25, Zki=c(rep(1.5, 5),
                                        rep(3, 6)), 100, 100/50) -
      c(0.028956026873118229786, 0.028514321584766966211, 0.028065487563002939481,0.027609157811218087986,
        0.027144931645364318157, 0.025976456119747082241, 0.024154891852984621686, 0.022401849101788291058,
        0.020717327866104584544, 0.019101328145692042515, 0.150836517508279338573))),
    0, tolerance=1.0e-8)
})

test_that("RSPR_0 function", {
  expect_equal(
    abs(RSPR_0(Galpha=100, Gbeta=100/50, Mk=1.5, blicc_ld=gillnet_ld) - 1.11297945726999),
    0, tolerance=1.0e-8)
})
